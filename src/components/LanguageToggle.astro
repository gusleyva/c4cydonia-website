---
---

<button
  id="language-toggle"
  class="inline-flex items-center px-3 py-1.5 border border-gray-300 dark:border-gray-700 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"
  aria-label="Toggle language"
>
  <span id="language-text">EN</span>
</button>

<script>
  type Language = 'es' | 'en';

  const languageToggle = document.getElementById('language-toggle') as HTMLButtonElement | null;
  const languageText = document.getElementById('language-text') as HTMLSpanElement | null;

  // Read current language or default to 'es'
  let currentLanguage: Language = (localStorage.getItem('language') as Language) || 'es';

  // Initialize label
  if (languageText) {
    languageText.textContent = currentLanguage === 'es' ? 'EN' : 'ES';
  }

  languageToggle?.addEventListener('click', () => {
    // Compute next language based on latest stored value
    const stored = (localStorage.getItem('language') as Language) || currentLanguage;
    const newLanguage: Language = stored === 'es' ? 'en' : 'es';

    localStorage.setItem('language', newLanguage);
    currentLanguage = newLanguage;

    if (languageText) {
      languageText.textContent = newLanguage === 'es' ? 'EN' : 'ES';
    }

    const event = new CustomEvent('languageChanged', {
      detail: { language: newLanguage }
    });
    document.dispatchEvent(event);
  });
</script> 
